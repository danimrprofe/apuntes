<!DOCTYPE html>
<html>
<head>
<title>bd-peliculas.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<ul>
<li><a href="#1-introducci%C3%B3n">1 Introducción</a></li>
</ul>
<h1 id="1-introducci%C3%B3n">1 Introducción</h1>
<p>¿Qué es una base de datos?</p>
<p>Una base de datos es un sistema organizado para recopilar, almacenar y gestionar datos. Permite a los usuarios almacenar, recuperar y manipular datos de manera eficiente.</p>
<p>Las bases de datos están estructuradas en tablas que contienen filas y columnas. Cada columna representa un tipo de datos específico y cada fila contiene una entrada de datos única.</p>
<p>¿Qué ventajas nos aporta una base datos?</p>
<p>Estructura de datos</p>
<p>Las bases de datos permiten organizar los datos en estructuras más complejas que los simples archivos de texto. Puedes tener tablas relacionadas entre sí, lo que facilita el manejo de datos complejos y su consulta.</p>
<p>Búsqueda eficiente</p>
<p>Las bases de datos están optimizadas para búsquedas rápidas y eficientes. Puedes buscar información en grandes conjuntos de datos de manera mucho más rápida que si tuvieras que hacerlo en un documento de texto extenso.</p>
<p>Integridad y consistencia de datos</p>
<p>Las bases de datos permiten definir reglas para asegurar que los datos sean coherentes y precisos. Se pueden establecer restricciones para evitar inconsistencias en los datos, lo cual es difícil de lograr en un documento de texto.</p>
<p>Seguridad</p>
<p>Las bases de datos pueden tener sistemas de seguridad avanzados para proteger los datos sensibles. Los documentos de texto, por otro lado, suelen estar menos protegidos y son más susceptibles a manipulaciones no autorizadas.</p>
<p>Escalabilidad</p>
<p>Las bases de datos pueden manejar grandes volúmenes de datos y son escalables. Puedes agregar más datos a medida que tu negocio crece, algo que podría ser problemático en un documento de texto.</p>
<p>Concurrencia</p>
<p>Las bases de datos permiten múltiples usuarios acceder y modificar datos simultáneamente sin corromper la información, algo que es difícil de gestionar en un documento de texto compartido.</p>
<p>Recuperación de datos</p>
<p>En caso de pérdida de datos, las bases de datos suelen tener sistemas de copia de seguridad y recuperación que facilitan la restauración de los datos a un estado anterior.</p>
<h1 id="2-instalaci%C3%B3n-y-entorno-base">2. INSTALACIÓN Y ENTORNO BASE</h1>
<p>¿Qué programa de bases de datos vamos a utilizar?</p>
<p>Libreoffice</p>
<p>Libreoffice es un conjunto de programas de ofimática, que además de ser libre, contiene otras herramientas como por ejemplo Calc o Writer, que nos ayudan a redactar informes o realizar cálculos.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image1.png" id="image1">
<p>Libreoffice base</p>
<p>Libreoffice base es un programa que nos permite guardar cualquier tipo de información de un tema en concreto en una base de datos, para actualizarla o consultarla en cualquier momento.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image2.png" id="image2">
<p>¿Qué tipos de bases de datos podemos encontrar?</p>
<p>Ejemplos de bases de datos podrían ser:</p>
<p>Información Académica</p>
<p>En este caso, se pueden gestionar datos relacionados con estudiantes, profesores, evaluaciones y amonestaciones, entre otros.</p>
<p>La base de datos puede incluir detalles sobre los alumnos, como nombres, direcciones y fechas de nacimiento, así como información sobre profesores y sus especialidades.</p>
<p>Además, se pueden registrar evaluaciones, notas y cualquier amonestación disciplinaria que ocurra en el ámbito educativo.</p>
<p>Información Hospitalaria</p>
<p>Las bases de datos también son fundamentales en entornos hospitalarios para organizar información relevante.</p>
<p>Esto puede incluir datos sobre pacientes, como historiales médicos, alergias y tratamientos anteriores.</p>
<p>Además, se pueden gestionar listas de espera para consultas y procedimientos, recetas médicas, detalles de enfermedades y datos sobre médicos, como sus horarios de consulta y especialidades.</p>
<p>¿Cómo se guarda toda esta información?</p>
<p>Toda esta información está guardada en forma de tablas que se interrelacionan entre ellas.</p>
<p>Primera ejecución de Base y creación de base de datos</p>
<p>Base forma parte del paquete de ofimática de Libreoffice. Una vez tenemos instalado Libreoffice base buscamos en inicio hasta dar con la aplicación.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image3.png" id="image3">
<p>Al entrar en Base nos encontraremos la ventana “Asistente para base de datos” donde se nos da a elegir entre crear una nueva base de datos, abrir una base de datos existente o conectar con una base de datos existente.</p>
<div class="break"></div>
<h1 id="3-crear-una-base-de-datos-de-peliculas">3. Crear una base de datos de peliculas</h1>
<p>Piensa en una base de datos como un archivo en el que vamos a guardar toda la información necesaria sobre la temática que queremos</p>
<p>En esta unidad se va a crear la base de datos que se usará el resto del curso; por tanto, en este caso, elegiremos la primera opción.</p>
<p>Una vez que esté creada y volvamos a entrar a Base tendremos que marcar la segunda opción y elegir nuestra base de datos.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image4.png" id="image4">
<p>Nos debe aparecer una ventana. Por un lado, debemos elegir entre registrar o no la base de datos y, por otro, entre abrir o no la base de datos para editarla y crear tablas usando el asistente. Lo vamos a dejar todo tal cual.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image5.png" id="image5">
<p>Para terminar, pulsamos sobre el botón finalizar.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image4.png" id="image6">
<p>¿Dónde guardaremos nuestra base de datos?</p>
<p>Es importante recordar dónde guardamos el archivo, puesto que en las próximas clases lo deberemos buscar para seguir trabajando.</p>
<p>La base de datos se guarda toda dentro de un único archivo en nuestro ordenador como este. La extensión que tienen los tipos de archivo de base de datos es .odb. Aparecerá un icono que nos muestra que este archivo es un archivo de base.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image6.png" id="image7">
<p>Para finalizar debemos elegir la carpeta donde guardaremos nuestra base de datos y el nombre de la misma.</p>
<p>La base de datos que vamos a crear se llamará Curso y la vamos a guardar en la subcarpeta Bases de Datos, dentro de la carpeta Escritorio</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image7.png" id="image8">
<h1 id="4-creamos-nuestra-primera-tabla">4. Creamos nuestra primera tabla</h1>
<p>Las bases de datos guardan la información en una o más tablas. Cada tabla guardará un tipo de objeto o una relación entre varios.</p>
<p>Para ello nos situamos en el entorno en el menú de tablas y, dentro de las tareas, pulsamos sobre crear tabla en vista diseño.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image8.png" id="image9">
<p>Nos aparece una pantalla para definir las columnas que tendrá la tabla . Por cada columna de nuestra futura tabla podemos indicar el nombre, el tipo de datos y una breve descripción sobre lo que almacenará dicha columna.</p>
<p>A continuación, nos aparecerá la siguiente ventana. Ahora aparece vacía porque acabamos de crear la tabla. Aquí vamos a definir qué campos va a contener nuestra tabla. Rellenaremos una fila para cada columna que queramos crear.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image9.png" id="image10">
<p>Crear el primer campo</p>
<p>Comenzamos a definir el primer campo: nos situamos en la primera fila de la rejilla y en la columna Nombre del campo escribimos Id_pelicula. Digamos que es el número que le asignaremos a cada película que luego introduzcamos en la tabla.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image10.png" id="image11">
<p>A continuación, tenemos que especificar qué tipo de datos guarda este campo: ¿un número, un texto, una fecha?</p>
<p>Por defecto, nos indica Texto[VARCHAR] como tipo de dato. En nuestro caso, para este campo vamos a elegir uno de los de tipo numérico llamado Número[Numeric]</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image11.png" id="image12">
<p>A continuación, en la columna Descripción, sería aconsejable que se introdujese un comentario acerca del campo que se acaba de insertar</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image12.png" id="image13">
<p>Crear clave primaria</p>
<p>En el caso de nuestra TABLA PELÍCULAS, a priori, no hay ningún campo acerca de una película que podamos utilizar para diferenciar una película de otra.</p>
<p>Por ejemplo, podemos tener dos películas con el mismo título o dos películas con el mismo director o dos películas que se produjeron el mismo año.</p>
<p>Para este tipo de tablas se suele definir un campo de tipo numérico (como acabamos de hacer nosotros con nuestro Id_pelicula) que debe cumplir dos condiciones:</p>
<p>Ese campo siempre tiene que tomar un valor para cada fila de la tabla</p>
<p>Dicho valor no puede repetirse en ninguna fila.</p>
<p>Cuando un campo cumple estas dos propiedades (sin nulos y sin repetidos) se le llama clave primaria o clave principal. Toda tabla debe tener una.</p>
<p>Para indicar que queremos que el campo Id_pelicula sea nuestra Llave Primaria seguimos los siguientes pasos:</p>
<p>Nos situamos en la parte izquierda del campo</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image13.png" id="image14">
<p>Pulsamos botón derecho del ratón</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image14.png" id="image15">
<p>Seleccionamos la opción Llave primaria</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image15.png" id="image16">
<p>Quedando finalmente el campo como se muestra. La llave indica que este campo es la clave principal de la tabla.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image16.png" id="image17">
<p>Crear el resto de campos</p>
<p>Una vez insertado este primer campo, insertaríamos el resto de columnas, que van a ser:</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image17.png" id="image18">
<p>Tipos de valores</p>
<p>En una base de datos, los tipos de datos son importantes porque definen qué tipo de valores pueden almacenarse en un campo específico de una tabla.</p>
<p>Numeric (Numérico)</p>
<p>Uso: Se utiliza para almacenar valores numéricos, como números enteros o decimales.</p>
<p>Ejemplo: Puedes usar este tipo de datos para almacenar valores como 1, 3.14, -42, etc.</p>
<p>Ejemplo de Declaración: NUMERIC(10, 2) indica un número con hasta 10 dígitos, 2 de los cuales pueden estar después del punto decimal.</p>
<p>Varchar (Variable Character):</p>
<p>Uso: Se utiliza para almacenar cadenas de texto de longitud variable.</p>
<p>Ejemplo: Puedes usar este tipo de datos para almacenar texto como nombres, descripciones, etc.</p>
<p>Ejemplo de Declaración: VARCHAR(255) indica una cadena de texto con una longitud máxima de 255 caracteres.</p>
<p>Date (Fecha)</p>
<p>Uso: Se utiliza para almacenar valores de fecha.</p>
<p>Ejemplo: Puedes usar este tipo de datos para almacenar fechas como 2023-10-22.</p>
<p>Ejemplo de Declaración: DATE indica un tipo de datos de fecha.</p>
<p>Boolean (Booleano):</p>
<p>Uso: Se utiliza para almacenar valores de verdad o falsedad (verdadero o falso).</p>
<p>Ejemplo: Puedes usar este tipo de datos para campos que necesitan representar estados como &quot;activado&quot; o &quot;desactivado&quot;.</p>
<p>Ejemplo de Declaración: En algunas bases de datos, BOOLEAN o BOOL se utiliza para definir un tipo de datos booleano.</p>
<p>Guardar la tabla</p>
<p>Una vez creados todos los campos con sus propiedades, debemos guardar la tabla. Para ello pulsamos sobre el icono en forma de disquete de la esquina superior izquierda</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image18.png" id="image19">
<p>A continuación, nos aparece una ventana que nos pide que introducimos el nombre de la tabla. En dicha ventana introducimos el nombre Peliculas y pulsamos el botón Aceptar.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image19.png" id="image20">
<p>Si hemos seguido todos los pasos correctamente, nuestra tabla Peliculas debe aparecer dentro del apartado Tablas en la parte inferior de la ventana principal</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image20.png" id="image21">
<p>Las tildes pueden producir problemas por lo que es mejor evitar su uso en los nombres.</p>
<p>Cambiar o modificar columnas</p>
<p>Si quisiéramos agregar o modificar columnas, elegimos editar.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image21.png" id="image22">
<div class="break"></div>
<h1 id="5-inserci%C3%B3n-de-datos-en-la-tabla-pel%C3%ADculas">5. Inserción de datos en la tabla películas</h1>
<p>Para insertar datos a través de la hoja de datos tenemos que situarnos en la pantalla principal de en el apartado de Tablas y hacer doble clic con el botón izquierdo del ratón sobre la tabla Películas</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image22.png" id="image23">
<p>Aparece entonces la pantalla de hoja de datos que se muestra.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image23.png" id="image24">
<p>En primer lugar, podemos ver que:</p>
<p>Aparecen las 6 columnas</p>
<p>Ninguna fila insertada</p>
<p>La columna Vista aparece con un cuadrado. Este cuadrado nos indica que es un campo del tipo Sí/No y que aparezca con fondo verde significa que no hay ninguna opción elegida por el momento.</p>
<p>La flecha indica el lugar en el que se va a insertar la información.</p>
<p>Para pasar de una celda a otra, recomiendo utilizar la tecla TAB.</p>
<p>Insertar una nueva fila en la tabla</p>
<p>A continuación, vamos a introducir la información de nuestra primera fila.</p>
<p>¡Ojo! No podemos dejar ninguna celda de la fila en blanco. De lo contrario, nos puede saltar un error</p>
<p>Deberá quedar así:</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image24.png" id="image25">
<p>Nota: Como no sabemos el día exacto en el que se estrenó cada una de las películas que tenemos, vamos a indicar siempre el 1 de enero</p>
<p>Si continuamos insertando filas, hay que hacer un recordatorio: la columna Id_pelicula iba a ser nuestra Llave Primaria; es decir, que los valores de este campo, no podían repetirse para ninguna fila.</p>
<p>Rellenar el resto de películas</p>
<p>A continuación, rellenamos el resto de filas, con la información de las películas, tal como se muestra.</p>
<p>Poned la información tal cual. Si modificamos algo, en ejercicios posteriores no os cuadrará el resultado.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image25.png" id="image26">
<h1 id="6-ordenar-tablas">6. Ordenar tablas</h1>
<p>Imaginad que queremos ver la lista por orden alfabético, o bien queremos ordenarlas de más nuevas a más antiguas. Para ello podemos ordenar la lista.</p>
<p>Podemos ordenar las filas según el valor de cualquiera de las columnas, tanto en orden descendente como ascendente.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image26.png" id="image27">
<p>Dentro de las opciones de ordenación tenemos tres posibilidades:</p>
<p>Especificar los criterios de clasificación para visualizar los datos</p>
<p>Ordenar de forma ascendente</p>
<p>Ordenar de forma descendente en función de la columna elegida.</p>
<p>Ejemplo de ordenación</p>
<p>supongamos que deseamos ordenar nuestras filas:</p>
<p>En primer lugar, en función de la columna Formato de forma ascendente</p>
<p>En el caso de que tengamos valores repetidos para esta columna, queremos que aplique el orden alfabético de los nombres de los directores en el campo director</p>
<p>En caso de que el nombre del director aparezca repetido, que ordene de la película más reciente a la más antigua usando el campo Año.</p>
<p>Es decir, los criterios de ordenación serían los que aparecen:</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image27.png" id="image28">
<p>El resultado debería ser el siguiente. Si no os cuadra, comprobad que habéis puesto bien la información y los criterios de ordenación.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image28.png" id="image29">
<h1 id="7-filtrado-de-datos">7. Filtrado de datos</h1>
<p>En ocasiones podemos querer buscar únicamente un conjunto de películas que cumplen cierta condición. Las opciones de filtrado de datos nos permiten elegir de forma simple qué datos queremos que se muestren.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image29.png" id="image30">
<p>Elegid los siguientes valores para visualizar las películas entre 1980 y 1989. Para ello, filtraremos por el campo año.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image30.png" id="image31">
<p>Tocarían dos resultados, que son los que coinciden con las condiciones que hemos establecido.+</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image31.png" id="image32">
<p>Lo que estamos viendo es la información filtrada, si volvemos a darle al icono del embudo <img src="media/image32.png" id="image33">, desactivaremos el filtro y veremos todas las películas de nuevo.</p>
<h1 id="8-editar-y-borrar">8. Editar y borrar</h1>
<p>Modificación y eliminación de datos</p>
<p>Los datos pueden sufrir variaciones a lo largo del tiempo o incluso desaparecer por distintos motivos.</p>
<p>Modificar y eliminar datos de nuestras tablas es un proceso muy habitual y simple de realizar y que no debería entrañar ningún problema.</p>
<p>Borrar una fila entera</p>
<p>No es necesario que borréis nada de momento</p>
<p>Para borrar una fila entera, basta con situarse con el cursor al inicio de la fila y seleccionar eliminar fila. Por ejemplo, imaginemos que la película Rocky que tenía en VHS se ha estropeado y ya no se puede ver, entonces me sitúo al inicio de esa fila y selecciono eliminarla.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image33.png" id="image34">
<div class="break"></div>
<h1 id="9-crear-la-tabla-int%C3%A9rpretes">9. Crear la tabla intérpretes</h1>
<p>Las películas están protagonizadas por actores y actrices. Para poder relacionarlo todo, vamos a crear una tabla nueva.</p>
<p>Crear la tabla</p>
<p>Crearemos una tabla llamada Interpretes con los siguientes campos. Al igual que con las películas, crearemos un campo especial que será el número que daremos a cada intérprete.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image34.png" id="image35">
<p>Rellenar la tabla</p>
<p>Una vez creada la estructura de la tabla, deberemos Insertar las siguientes filas en ella.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image35.png" id="image36">
<p>Repaso</p>
<p>Ahora deberíamos tener dos tablas creadas. Repasa que están todos los datos en ella y que no se te ha olvidado nada, antes de continuar.</p>
<h1 id="10-tipos-de-datos-y-edici%C3%B3n-de-tablas">10. Tipos de datos y edición de tablas</h1>
<p>Edición de tablas</p>
<p>Para abrir esta tabla para editarla tenemos que situarnos en el apartado de Tablas y hacer un clic con el botón derecho del ratón y seleccionar la opción Editar</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image21.png" id="image37">
<p>Agregar o eliminar columnas</p>
<p>Para añadir nuevas columnas a nuestra tabla hay que seguir el mismo proceso que en la creación de una tabla; es decir, introducir un valor para el nombre del campo, elegir un tipo de campo y escribir una descripción de ese campo.</p>
<p>Para eliminar columnas de nuestra tabla nos situamos al inicio del campo y seleccionamos la opción eliminar. Antes de eliminar una columna de nuestra tabla debemos saber que al hacerlo se borrarán todos los valores que tuviéramos dados a esta columna en nuestra filas.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image36.png" id="image38">
<p>En el caso de haber borrado una columna de la tabla accidentalmente siempre tenemos la opción de cerrar la ventana de edición sin guardar los cambios realizados.</p>
<p>Modificación de columnas existentes</p>
<p>Las modificaciones que se pueden realizar sobre las columnas existentes pueden ser de dos tipos:</p>
<p>Cambios de nombre del campo o de la descripción del mismo.</p>
<p>cambio en las propiedades del campo, desde ser o no clave primaria, a cambiar el tipo de campo y las propiedades asociadas a ese tipo de campo.</p>
<h1 id="11-relaciones-entre-tablas">11. Relaciones entre tablas</h1>
<p>Una de las grandes ventajas de las bases de datos es que podemos tener toda la información que necesitamos almacenar en varias tablas, relacionadas entre ellas, en lugar de una única tabla enorme con toda la información.</p>
<p>Se podría pensar en añadir una nueva columna (no la hagáis) a la tabla Peliculas que se llamara Género, de manera que por cada película almacenada también tuviera su género.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image37.png" id="image39">
<p>Si nos fijamos en esta solución podemos ver que se está repitiendo el mismo valor muchas veces, por ejemplo, Ciencia-Ficción aparece en cuatro filas y Drama en otras tantas.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image37.png" id="image40">
<p>¿Qué problemas podemos tener si lo hacemos así?</p>
<p>Que en algún momento nos equivoquemos al teclear, y escribamos, por ejemplo, Ciencia-Fusión.</p>
<p>Qué decidamos cambiar el nombre de un género, y por tanto tendríamos que cambiarlo en todas las filas.</p>
<p>Crear tabla de géneros</p>
<p>La información de géneros la vamos a crear en una nueva tabla e indicaremos de alguna forma que hay filas de la tabla PELICULAS y de la tabla GENEROS que están relacionadas.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image38.png" id="image41">
<p>id_genero hay que ponerlo como clave principal.</p>
<p>Valor automático</p>
<p>Seleccionado el campo id_genero, vamos a marcar valor automático a SI. De este modo, no tendremos que rellenar este campo cuando rellenemos información de la tabla. En lugar de esto, se rellenará con el siguiente número disponible.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image38.png" id="image42">
<p>Y la guardamos con el nombre generos.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image39.png" id="image43">
<p>Repaso de tablas</p>
<p>Ahora mismo deberíais tener 3 tablas:</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image40.png" id="image44">
<p>Rellenar la tabla generos</p>
<p>Vamos a rellenar la tabla generos. En la primera columna no tenemos que poner nada, siempre se pondrán los valores automáticamente cuando pasemos a la siguiente fila.</p>
<p>🚩 Si no se autocompletan los números, revisa que id_genero sea clave principal.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image41.png" id="image45">
<p>Información de intérpretes</p>
<p>También vamos a suponer que quisiéramos almacenar información (apellidos, nombre y nacionalidad) acerca de los principales intérpretes con cada una de nuestras películas.</p>
<p>A pesar de haber creado una tabla INTÉRPRETES  anteriormente, podríamos haber pensado en agregar columnas a la tabla PELICULAS donde guardar la información acerca de sus protagonistas.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image42.png" id="image46">
<p>Esta solución es difícil de mantener y puede dar multitud de problemas y errores, por lo ya habíamos creado una tabla INTÉRPRETES</p>
<p>TIPOS DE RELACIONES ENTRE TABLAS</p>
<p>Para ver la forma de establecer la relación es necesario decidir, previamente, qué tipo de relación existe entre las tablas. Existen tres tipos básicos de relaciones entre tablas:</p>
<p>Uno a muchos (pelicula y género)</p>
<p>Cuando una fila de la primera tabla puede estar relacionada con muchas filas de la segunda tabla, pero una fila de la segunda sólo está relacionada con una de la primera.</p>
<p>Una película puede tener un único género pero un género puede serlo de varias películas.</p>
<p>Muchos a muchos</p>
<p>Esta clase de relación ocurre cuando una fila de la primera tabla puede estar relacionada con muchas filas de la segunda tabla y una fila de la segunda tabla puede estarlo con muchas filas de la primera.</p>
<p>Un ejemplo de este tipo lo tenemos en la relación entre la tabla Peliculas y la tabla Interpretes</p>
<p>Una película en particular puede tener muchos intérpretes y viceversa.</p>
<p>Uno a uno</p>
<p>Cuando una fila de la primera tabla sólo puede estar relacionada con una fila de la segunda y viceversa.</p>
<p>Por ejemplo una tabla con países y otra con jefes de gobierno, dado que, normalmente, un país sólo tiene un jefe de gobierno y un jefe de gobierno lo es sólo de un país.</p>
<p>Establecer relaciones entre tablas</p>
<p>En función del tipo de relación, los pasos a realizar para indicarlas son distintos.</p>
<p>A continuación, se explica al detalle las reglas básicas para los tipos uno a muchos y muchos a muchos.</p>
<p>Relaciones uno a muchos</p>
<p>Para este tipo de relaciones la solución siempre es crear una nueva columna en la tabla del lado del muchos, es decir, debemos crear una nueva columna en la tabla cuyas filas sólo pueden estar relacionadas con una fila de la otra tabla, de manera que el valor de ese campo me indique sin lugar a dudas con qué fila está relacionada de la otra tabla.</p>
<p>En el caso de Generos y Peliculas, esto supone que tenemos que crear en Peliculas un nuevo campo que para cada película mantenga un valor que me indique sin error al género al que pertenece.</p>
<p>Por tanto, la columna debe ser del mismo tipo de dato que la columna que sea clave primaria en la otra tabla y los valores que podrá contener será cualquiera de los valores que tome la clave primaria en dicha tabla.</p>
<p>Crear columna género dentro de la tabla películas</p>
<p>Es decir, en la tabla Peliculas tendremos que crear una columna del mismo tipo que a la que llamaremos Genero.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image43.png" id="image47">
<p>Los valores que pondremos en esa columna estarán comprendidos en los distintos valores que toma ese valor en la tabla Generos .</p>
<p>Rellenar género de las películas</p>
<p>Como la columna que hemos creado en la tabla películas es nueva, tendremos que completarla con el número correspondiente al género al  que pertenece la película.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image44.png" id="image48">
<p>Herramienta relaciones</p>
<p>Falta indicarle que las dos tablas están relacionadas y que vamos a utilizar para mantener dicha relación la nueva columna id_genero que hemos creado en peliculas.</p>
<p>Para realizar esta operación tenemos que abrir la herramienta QUE SOLO ENCONTRARÉIS EN LA VENTANA PRINCIPAL, llamada Relaciones. <img src="media/image45.png" id="image49"></p>
<p>Veréis que se abre una ventana nueva.</p>
<p>Añadir las tablas que vamos a utilizar</p>
<p>Lo primero que nos ocurre nada más entrar en la ventana Relaciones. Seleccionamos cada tabla y le damos a añadir.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image46.png" id="image50">
<p>Deberemos ver esto. Las tablas que aquí vemos las podremos unir con flechas. Estas flechas que pondremos indicarán las relaciones que tienen entre ellas.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image47.png" id="image51">
<p>Relación género - películas</p>
<p>A continuación, ya podemos establecer la relación que queremos indicar. Para ello pinchamos en el icono que aparece a la derecha en la ventana relaciones</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image48.png" id="image52">
<p>Entonces, nos debe aparecer una ventana donde primero debemos indicar las tablas que queremos relacionar para, a continuación, elegir en función de qué columna vamos a establecer la relación. Debería quedar así:</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image49.png" id="image53">
<p>En la parte inferior de esta ventana veremos que nos pide que indiquemos dos opciones:</p>
<p>la de actualización</p>
<p>la de eliminación</p>
<p>Nos ofrece cuatro posibilidades para cada una de ellas. Estas opciones sirven para indicar qué hacer si algún valor del campo de clave primaria que está siendo referenciada (en nuestro caso Id_genero) sufre alguna modificación o si esa fila es eliminada.</p>
<p>Para la actualización, lo normal suele ser elegir la posibilidad de actualizar en cascada, y para el borrado no existe una opción preferida, sino que dependerá bastante del contexto, en nuestro caso, para esta relación, indicaremos poner a nulos.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image51.png" id="image54">
<p>Le damos a aceptar</p>
<p>VISUALIZAR LA RELACIÓN CREADA</p>
<p>Una vez hemos terminado de indicar la relación, ésta debe aparecer indicada tal y como se muestra.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image52.png" id="image55">
<p>Ahora aparece una línea uniendo ambas tablas y que en el extremo de esa línea;</p>
<p>En el lado de la tabla Generos aparece el valor 1</p>
<p>En el extremo de la tabla Peliculas, nos aparece el valor n.</p>
<p>Estos valores nos están indicando que el tipo de relación es de uno (1) a muchos (n).</p>
<p>RELACIÓN ENTRE PELÍCULAS E INTÉRPRETES</p>
<p>En este caso puede darse el caso de:</p>
<p>1 película que tiene N intérpretes</p>
<p>1 intérprete que participa en N películas</p>
<p>La relación entre películas e intérpretes es de muchos a muchos (N a N).</p>
<p>Cuando esto pasa, no basta con añadir una columna. Necesitamos crear una nueva tabla.</p>
<p>Crear tabla protagonistas</p>
<p>Relación entre películas e intérpretes</p>
<p>En este caso puede darse el caso de:</p>
<p>1 película que tiene N intérpretes</p>
<p>1 intérprete que participa en N películas</p>
<p>La relación entre películas e intérpretes es de muchos a muchos (N a N). Cuando esto pasa, no basta con añadir una columna. Necesitamos crear una nueva tabla.</p>
<p>A esta tabla la llamaremos Protagonistas con, al menos, dos columnas:</p>
<p>Identificador de película</p>
<p>Identificador de intérprete cada una de ellas para apuntar a cada una de las claves primarias respectivas de las tablas que queremos relacionar</p>
<p>Cada fila de esta tabla va a representar las relaciones que existen entre las filas de ambas tablas.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image53.png" id="image56">
<p>Rellenar filas de la tabla</p>
<p><img src="media/image54.png" id="image57">Rellenaremos la tabla, asignando a cada id de película, un id de intérprete. La tabla es la que veis a la izquierda. Si os fijáis:</p>
<p>La película 1 es blade runner, protagonizada por Harrison ford (intérprete número 1)</p>
<p>La película 2 es la guerra de las galaxias, protagonizada también por él (intérprete 1)</p>
<p>Etc.</p>
<p>Como veis la tabla protagonistas enlaza las películas con sus intérpretes, y viceversa.</p>
<h1 id="13-crear-relaciones-entre-las-tablas-int%C3%A9rprete-protagonistas-y-pel%C3%ADculas">13. Crear relaciones entre las tablas intérprete, protagonistas y películas</h1>
<p>Ahora hemos creado la tabla protagonistas, pero no está relacionada con las tablas PELICULAS y INTERPRETES.  Para asegurarnos que todo funcione y que tengan información correcta, tenemos que relacionarlas.</p>
<p>Añadir tablas</p>
<p>Así, una vez que nos hemos situado de nuevo en la ventana Relaciones y hemos añadido las tablas que queremos relacionar a dicha ventana.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image55.png" id="image58">
<p>Crear relaciones</p>
<p>Aquí veis las dos tablas que hemos añadido, pero que no están conectadas con nada más. Ahora vamos a enlazar estas 3 tablas entre sí:</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image56.png" id="image59">
<div class="break"></div>
<p>Relación películas y protagonistas</p>
<p>Relacionamos los campos id_pelicula de las dos tablas. Comprobaréis que aparece 1 y n, indicando que un valor de id_pelicula en la tabla PELICULAS aparece más de una vez en la tabla PROTAGONISTAS.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image58.png" id="image60">
<p>Relación Protagonistas e Interpretes</p>
<p>Del mismo modo relacionamos estas dos tablas, a través del campo id_interprete que aparece en ambas tablas.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image59.png" id="image61">
<p>Resumen de relaciones</p>
<p>Resumiendo, al final las relaciones tienen que quedar así.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image60.png" id="image62">
<h1 id="14-consultas-simples">14. Consultas simples</h1>
<p>Las consultas nos permiten visualizar parte de la información contenida en nuestras bases de datos desde una perspectiva más detallada</p>
<p>Se pueden realizar sobre una o varias tablas relacionadas. El resultado que devuelven se muestra también en forma de tabla.</p>
<p>Las consultas son muy útiles a la hora de construir formularios y, sobre todo, informes, como ya veremos más adelante.</p>
<p>Creación de consultas sobre una tabla utilizando el asistente</p>
<p>Vamos a comenzar realizando una consulta que nos devuelva de la tabla Interpretes , el nombre, los apellidos y la nacionalidad de los que no son españoles.</p>
<p>Para ello, teniendo seleccionada la sección “Consultas”, nos situamos sobre el apartado de tareas y elegimos “Usar el asistente para crear consulta…”.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image61.png" id="image63">
<p>Nos aparece entonces la primera ventana del asistente donde debemos elegir qué campos queremos que se muestren, y seleccionamos entonces los campos Nombre, Apellidos,y Nacionalidad de la tabla Interpretes.</p>
<p>Tiene que quedar así:</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image62.png" id="image64">
<p>A continuación, podemos elegir si queremos que se muestren ordenados en función de los valores de uno o varios campos. Nosotros vamos a seleccionar que se ordenen alfabéticamente por los apellidos del intérprete.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image63.png" id="image65">
<p>En el siguiente paso podemos elegir si queremos indicar uno o varios criterios de búsqueda; es decir, si queremos que las filas que se muestran cumplan alguna condición en particular.</p>
<p>Como en nuestro caso el objetivo es mostrar sólo los intérpretes no españoles, debemos indicar que para el campo Nacionalidad no deseamos aquellos que contengan el valor “Español” (ver Figura 5.5).</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image64.png" id="image66">
<p>A continuación, podemos elegir con qué nombre (alias), se mostrarán las cabeceras de las columnas de los campos que hemos elegido al mostrar el resultado de la consulta. En este caso, como los nombres de los campos son bastante claros simplemente les quitamos el nombre de la tabla que figura delante del nombre (ver Figura 5.6).</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image65.png" id="image67">
<p>A continuación podemos cambiar el nombre de la consulta si queremos:</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image66.png" id="image68">
<p>Como resultado veremos el listado ordenado por apellido en orden ascendente, y evitando los intérpretes españoles.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image67.png" id="image69">
<p>Siempre que queramos hacer esta consulta, simplemente hacemos doble clic sobre su nombre:</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image68.png" id="image70">
<h1 id="15-consultas-sobre-varias-tablas-combinando-el-asistente-con-el-modo-dise%C3%B1o">15. Consultas sobre varias tablas combinando el asistente con el modo Diseño</h1>
<p>Ahora vamos a realizar una consulta que nos muestre las películas junto con el nombre del género al que pertenecen.</p>
<p>Para realizar esta consulta primero vamos a utilizar el asistente para conseguir un primer “borrador” de la consulta que queremos realizar para, finalmente, acabar de concretar en modo Diseño.</p>
<p>Por tanto, empezamos de nuevo yendo a la sección tareas del tipo de objeto consulta y elegimos “Usar el asistente para crear consulta…”.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image69.png" id="image71">
<p>Ahora, en la ventana inicial del asistente, elegimos los campos Titulo, Director, Año y Formato de la tabla Películas</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image70.png" id="image72">
<p>En la siguiente ventana (Figura 5.10) vamos a indicar que queremos que el resultado se ordene, en primer lugar, en función del campo Director, y, en caso de coincidir el director entre distintas películas, en función del campo Titulo.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image71.png" id="image73">
<p>En esta consulta no vamos a poner ninguna condición por la que filtrar los datos, por lo que nos vamos directamente a la ventana “Alias” (Figura 5.11), donde vamos a aprovechar para “maquillar” que el campo Título no tuviera tilde al crear dicho campo y ahora sí se la incluimos. Además, para que el campo Año quede más concreto lo vamos a presentar como Fecha de estreno.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image72.png" id="image74">
<p>Antes de finalizar con el asistente, en la ventana “Información general” del mismo, debemos incluir el nombre de la consulta, que en este caso va a ser  Consulta_Peliculas_Generos,</p>
<p>Vamos a indicar también que no queremos que se muestre el resultado de la consulta, sino que queremos seguir trabajando con ella en modo Diseño.</p>
<p>Para esto último debemos activar la casilla “Modificar consulta” en dicha ventana</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image73.png" id="image75">
<p>Modo diseño</p>
<p>Nos debe aparecer entonces una ventana que permite crear consultas en modo Diseño.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image74.png" id="image76">
<p>En primer lugar, podemos ver que la ventana aparece dividida en dos partes bien diferenciadas:</p>
<p>Una que contiene la tablas que estamos utilizando en la consulta</p>
<p>Otra con los campos que ya habíamos seleccionado en el asistente junto con una serie de opciones que podemos indicar para cada uno de ellos.</p>
<p>Así, podemos ver que aparecen los campos Titulo, Director, Año y Formato junto con los alias que indicamos en el asistente y la opción de que se ordene la consulta en función del campo Director.</p>
<p>Algo que seguro nos ha llamado la atención es por qué aparece el campo Titulo dos veces. La respuesta es que, debido a que en el orden en que queremos que se muestren los campos es: primero el campo Titulo, y luego el Director, y en el asistente hemos indicado que primero queremos la ordenación en función del nombre del director, y, en caso de repetirse dicho nombre, ordenar por el título de la película.</p>
<p>La única forma de indicar esto es poniendo de nuevo el campo Titulo detrás de los otros cuatro, indicando que se ordene de manera ascendente pero desmarcando la casilla “Visible” para que no aparezca dos veces este campo en el resultado de la consulta.</p>
<p>Ya hemos visto entonces que en el modo Diseño nos aparecen los campos de Peliculas que deseamos pero aún no hemos hecho nada para ver el nombre del género de la película.</p>
<p>Como el nombre del género es un campo de la tabla Generos lo primero que tenemos que hacer es indicar que queremos incluir dicha tabla en la consulta. Para ello, debemos seleccionar el icono “Añadir tablas” (ver Figura 5.14), que es el primero por la izquierda de los iconos de la fila inferior y elegir la tabla Generos.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image75.png" id="image77">
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image76.png" id="image78">
<p>Podemos observar que automáticamente detecta que estas dos tablas están relacionadas.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image77.png" id="image79">
<p>Pues lo mismo que si hubiéramos intentado elegir los campos de ambas tablas directamente en el asistente, que la respuesta a la consulta hubiera sido que cada fila de la primera tabla aparecería unida a cada una de las filas de la otra tabla sin ningún criterio, es decir, en nuestro caso tendríamos 90 filas (resultado del producto cartesiano de 10 filas de Peliculas por 9 que tenemos en Generos) de las cuales 80 no significan nada.</p>
<p>Pero al haber indicado que existe la relación y detectarse en el modo Diseño conseguimos, sin necesidad de indicarlo explícitamente, que a la hora de mostrar todas las filas de Peliculas y Géneros, sólo nos muestre aquellas donde el valor para el campo por el que están relacionadas (Genero e Id_genero respectivamente) sea el mismo, es decir, que sólo nos muestre juntas las filas de ambas tablas que realmente están relacionadas.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image78.png" id="image80">
<p>Una vez hemos añadido la tabla Generos, elegimos qué campos queremos mostrar de ella. En este caso, nos basta con el campo Nombre.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image79.png" id="image81">
<p>Una vez que hemos elegido el campo, no debemos olvidar comprobar que la opción “Visible” está marcada para que se muestre este campo en el resultado de la consulta.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image80.png" id="image82">
<p>Alias</p>
<p>En la opción “Alias” del campo nombre_genero de la TABLA GENEROS vamos a mostrar la palabra “Género” para que cualquier usuario entienda mejor lo que mostrará esta columna.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image81.png" id="image83">
<p>Dentro del modo Diseño podemos comprobar si la consulta devuelve lo que queremos sin necesidad de cerrar esta ventana y lanzar la consulta desde el menú principal.</p>
<p>Para ello, basta con seleccionar el icono de ejecución de la consulta que se encuentra situado el segundo por la derecha en la fila de iconos superiores. Así, nos aparece entonces en la parte superior de la ventana el resultado de la consulta.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image82.png" id="image84">
<p>Veremos que se nos muestran los resultados:</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image83.png" id="image85">
<p>Si estamos conformes con el resultado, guardamos la consulta y podemos ver en la ventana principal que las dos consultas de esta unidad aparecen ya almacenadas.</p>
<h1 id="16-consultas-avanzadas">16. CONSULTAS AVANZADAS</h1>
<p>Entorno de trabajo en vista Diseño</p>
<p>En la unidad anterior ya trabajamos en modo diseño , pero ahora vamos a ver en detalle todos los elementos de esta forma de realizar consultas.</p>
<p>Primero, podemos observar que la vista diseño está dividida horizontalmente en tres partes:</p>
<p>La parte superior, con la barra de herramientas</p>
<p>La central, donde se muestran las tablas seleccionadas para la consulta</p>
<p>La inferior, donde cada columna representa cada uno de los campos a mostrar junto con una serie de opciones relacionadas para el filtrado de los resultados.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image84.png" id="image86">
<ol start="2">
<li>Creación en vista Diseño de consulta sobre varias tablas</li>
</ol>
<p>Vamos a crear nuestra primera consulta completamente en vista Diseño. En particular, vamos a crear una consulta que nos muestre todos los actores que protagonizan películas junto con los datos de la película, incluido el nombre del género. Es decir, vamos a construir una consulta que utiliza las cuatro tablas de nuestra base de datos.</p>
<p>Para empezar, nos vamos a la ventana principal, a la sección Consultas y seleccionamos la tarea Crear consulta en vista Diseño.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image85.png" id="image87">
<p>Seleccionar tablas a utilizar en la consulta</p>
<p>Nada más entrar en el modo Diseño, nos mostrará una ventana donde indicar las tablas que queremos incluir en la consulta que se va a crear. En nuestro caso, vamos a añadir las cuatro disponibles y veremos como nos muestra las relaciones existentes automáticamente.</p>
<p>Las puedes recolocar un poco para que te sea más fácil ver las relaciones</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image86.png" id="image88">
<p>Especificar criterios de la consulta</p>
<p>A continuación, vamos a especificar que queremos que los resultados de la consulta se muestran ordenados por los apellidos y el nombre de los intérpretes.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image87.png" id="image89">
<p>Para incluir los campos de la tabla Peliculas vamos a seleccionar Peliculas:* y así no tenemos que incluir los campos uno a uno</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image88.png" id="image90">
<p>Para seleccionar los campos de la tabla Interpretes no hemos utilizado la posibilidad “Interpretes.*” porque es necesario seleccionar cada campo individualmente, ya que vamos a establecer algún criterio de ordenación en función de alguno de los campos de la tabla.</p>
<p>Como en nuestro caso vamos a mostrar los resultados ordenados en función de los apellidos y el nombre de los intérpretes (ver Figura 6.4) necesitamos seleccionar uno a uno cada campo de Interpretes.</p>
<p>Para terminar, vamos a seleccionar el campo Nombre de la tabla Generos y, en el alias, vamos a poner “NombreGenero”, para distinguirlo de los campos ya seleccionados, Nombre de la tabla Interpretes y genero de la tabla Peliculas.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image89.png" id="image91">
<p>Guardamos la consulta con el nombre “ConsultaTotal” y al ejecutarla el resultado es el siguiente:</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image90.png" id="image92">
<h1 id="17-consultas-con-funciones">17. Consultas con funciones</h1>
<p>Imaginad que queremos un recuento de cuantas películas tenemos de cada género. Para ello necesitamos contar las que corresponden a cada género. Vamos a crear una consulta que realiza operaciones sobre los resultados.</p>
<p>Así, vamos a crear una consulta que muestre el nombre de cada género almacenado y el total de películas que tenemos de cada género. El resultado de nuestra consulta, con las filas que tenemos actualmente en Generos y Peliculas, debe ser como la siguiente:</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image91.png" id="image93">
<p>El objetivo es realizar una consulta sobre Generos y Peliculas de manera que agrupemos las filas devueltas en función de cada género para así poder contarlas y poder saber el número de películas asociadas a cada uno de ellos.</p>
<p>Para empezar, elegimos las tablas sobre las que vamos a realizar la consulta, Generos y Peliculas.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image92.png" id="image94">
<p>Los campos que necesitamos son, por un lado, Nombre de Generos, que es sobre el que agruparemos los resultados devueltos y, por otro, un campo de la tabla Peliculas que estemos seguros que siempre tendrá un valor (no estará vacío) para cada fila de Peliculas.</p>
<p>Por ejemplo, podemos elegir el campo id_pelicula que siempre va a tener valor para cada película. Los campos seleccionados se muestran.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image93.png" id="image95">
<p>A continuación, debemos asociar la función correspondiente a cada uno de los dos campos.</p>
<p>La función “agrupar”</p>
<p>En primer lugar, hemos dicho que queremos agrupar los resultados en función de cada género, para ello vamos a incluir la función “Agrupar” asociada al campo Nombre de Generos.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image94.png" id="image96">
<p>En segundo lugar, lo que queremos es contar las películas relacionadas con cada género. Esto último lo conseguimos asociando la función “Cantidad” al campo Id_pelicula de Peliculas.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image94.png" id="image97">
<p>Guardamos entonces la consulta como “Peliculas de cada Genero”</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image95.png" id="image98">
<p>Al lanzarla nos encontramos una pantalla como esta:</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image96.png" id="image99">
<p>Poner título a la columna calculada</p>
<p>Como vemos, la cabecera con el total de películas está mostrando la función que estamos utilizando junto con el nombre del campo.</p>
<p>Si queremos que el resultado aparezca como el que mostraremos en la figura., es decir, con una cabecera significativa, debemos añadir el alias “Total de Peliculas”.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image95.png" id="image100">
<h1 id="18-vistas-consultas-sobre-vistas">18. Vistas. Consultas sobre vistas</h1>
<p>Las vistas son un tipo especial de consultas almacenadas que, a nivel de bases de datos, se tratan como una tabla más.</p>
<p>¿Qué ocurre si necesitamos realizar una consulta no sobre una tabla sino sobre los resultados de otra consulta?</p>
<p>La respuesta es que debemos convertir la consulta en una vista para que se pueda manejar como si de una tabla se tratara.</p>
<p>Para ver los beneficios de usar vistas, vamos a realizar una consulta que nos devuelva el valor medio de las películas asociadas a cada género.</p>
<p>Esta consulta no se puede realizar directamente sobre las tablas Generos y Peliculas sino sobre la consulta Películas de cada Género una vez convertida en vista.</p>
<p>Convertir una consulta en una vista</p>
<p>Para convertir una consulta en una vista nos situamos en la ventana principal  en la sección “Consultas” y:</p>
<p>Seleccionamos la consulta que queramos convertir con el botón derecho del ratón.</p>
<p>Del menú que se despliega seleccionamos la opción “Crear como vista”.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image97.png" id="image101">
<p>Se nos despliega entonces una ventana donde tenemos que poner un nombre a la vista, escribimos “PeliculasCadaGenero” y aceptamos. Ya hemos convertido la consulta en una vista y podemos ver que ya es así si nos situamos en la sección “Tablas” de la ventana principal (ver Figura 6.15). Podemos observar que se usa un icono distinto para representar vistas y distinguirlas de las tablas.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image98.png" id="image102">
<p>Crear una consulta sobre la vista</p>
<p>Una vez que ya tenemos la vista, vamos a crear una consulta sobre ella. Para empezar, vemos que al entrar en vista Diseño para crear una nueva consulta ya nos aparece PeliculasCadaGenero como si de una tabla más se tratara y la elegimos como única tabla de la consulta.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image99.png" id="image103">
<p>Como sólo queremos que nos devuelva el valor medio de las películas de cada género seleccionamos el campo Total de Peliculas y le asociamos la función “Promedio” junto con el alias “Media de cada género”.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image100.png" id="image104">
<p>Para ver que la consulta hace lo que esperamos en la propia vista Diseño (ver Figura 6.18), la lanzamos antes de guardarla utilizando el botón “Ejecutar” y, si devuelve el valor esperado, ya hemos terminado.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image101.png" id="image105">
<h1 id="19-formularios">19. FORMULARIOS</h1>
<p>Las bases de datos van a ser usadas por personas que no tienen conocimientos técnicos. Para ello, resulta útil crear formularios que les ayuden en la tarea de rellenar y consultar información.</p>
<p>Los formularios permiten la introducción de datos en las tablas de una forma más sencilla y más limpia. En vez de introducir los datos directamente sobre la tabla, los datos se introducen en la tabla a través de los formularios.</p>
<p>En una base de datos se puede crear más de un formulario basado en una misma tabla.</p>
<p>Un formulario puede tomar varios campos de una tabla o todos; incluso puede tomar campos de diferentes tablas o consultas.</p>
<p>Las tablas almacenan la información, los formularios se encargan de recogerla.</p>
<p>Entorno de creación de un formulario</p>
<p>Para crear un formulario nos vamos a encontrar dos posibilidades dentro del apartado de tareas disponibles en la sección formularios:</p>
<p>Creación de formularios en vista Diseño: permite crear un formulario totalmente personalizado.</p>
<p>Usar el asistente para crear formulario: crea automáticamente un formulario con los campos que el usuario seleccione.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image102.png" id="image106">
<p>Nosotros vamos a crear formularios en la vista Diseño porque nos permite configurarlos con más detalles. Para ello pulsamos sobre “Crear formulario en vista Diseño…”. Nos aparece entonces la ventana de diseño de formularios</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image103.png" id="image107">
<p>Controles de formularios</p>
<p>Toda la información de un formulario está contenida en los controles.</p>
<p>Los controles son objetos de un formulario que muestran datos, realizan acciones o decoran el formulario.</p>
<p>Los controles pueden ser dependientes, independientes o calculados:</p>
<p>Control dependiente: está unido a un campo de una tabla o consulta. Los controles dependientes se utilizan para mostrar, introducir y actualizar valores de los campos de la base de datos.</p>
<p>Control independiente: no tiene un origen en una tabla o consulta. Los controles independientes se pueden utilizar para mostrar información, líneas, rectángulos e imágenes, independientemente de que estos existan en la tabla creada de antemano.</p>
<p>Control calculado: el origen de los datos es una expresión, no un campo. Una expresión es una combinación de operadores (=,+,-,* y /), nombres de controles, nombres de campos, funciones que devuelven un solo valor y valores constantes. La expresión puede incluir datos de un campo de la tabla o consulta del formulario o datos de otro control del formulario.</p>
<p>Los distintos campos de control se encuentran repartidos en las dos barras de herramientas que aparecen resaltadas en la Figura 7.2; por un lado, la barra “Diseño de Formularios” y, por otro, la barra “Campos de control de formulario”.</p>
<p>Si esta última barra no nos apareciera por cualquier motivo, se puede acceder a ella a través del menú “Ver”, eligiendo la opción “Barra de Herramientas” y activando la casilla “Campos de control de formulario”.</p>
<p>Antes de conocer los controles más importantes de ambas barras es recomendable, para hacer más cómodo el diseño de formularios, incrustar la barra “Campo de Control…” con el resto de barras de herramientas; para ello, basta con hacer doble clic con el ratón sobre la cabecera de esta barra y la ventana de diseño de formularios nos quedará como aparece.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image104.png" id="image108">
<p>En esta última barra, por defecto, no aparecen todos los controles disponibles; si queremos que aparezcan todos, debemos pulsar el icono que abre la barra de herramientas “Más campos de control” y nuestra ventana de trabajo debería quedar como la que aparece</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image105.png" id="image109">
<p>Creación de un formulario básico.</p>
<p>El primer formulario que vamos a crear en Vista Diseño es uno para la tabla Interpretes que nos va a permitir introducir los intérpretes de una película.</p>
<p>Lo primero que vamos a hacer dentro de la ventana de edición de formularios es indicar cómo se va a llamar el formulario y con qué tabla va a estar conectado.</p>
<p>Para ello, pulsamos sobre el icono “Navegador de formulario” y hacemos clic con el botón derecho sobre el campo “Formulario”, elegimos la opción “Nuevo” y, dentro de ésta, “Formulario”.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image106.png" id="image110">
<p>Por defecto, al nuevo formulario lo llama Standard pero nosotros lo vamos a renombrar como Form_Interpretes.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image107.png" id="image111">
<p>Para indicar que el formulario va a estar conectado con la tabla Interpretes hacemos clic con el botón derecho del ratón en el navegador de formulario sobre Form_Interpretes y elegimos “Propiedades”.</p>
 <img src="file:///e:/Docencia/apuntes/basesdedatos/media/image108.png" id="image112">
<p>En el cuadro resultante, vamos a la ficha “Datos”, y seleccionamos dentro “Contenido”. Abrimos el menú desplegable y seleccionamos la tabla sobre la que vamos a construir el formulario, en nuestro caso Interpretes</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image109.png" id="image113">
<p>Guardar el formulario</p>
<p>Cerramos las ventanas “Propiedades del formulario” y “Navegador de formulario” y, antes de continuar, guardamos el formulario pulsando en la pestaña “Archivo” y dentro “Guardar”, y también aquí le nombramos como Form_Interpretes.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image110.png" id="image114">
<p>Crear campo de texto</p>
<p>Ahora ya podemos continuar con la creación del formulario. En primer lugar, vamos a crear un campo de texto. Para ello,</p>
<p>Seleccionamos “Campo de texto” de entre todos los controles disponibles.</p>
<p>Veremos que el cursor cambia de forma, y es cuando podemos insertar dicho campo.</p>
<p>Llevamos el cursor a la posición de la zona de trabajo</p>
<p>Lo arrastramos hasta que el campo de texto alcance el tamaño deseado.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image111.png" id="image115">
<p>Ahora tenemos que dar unas propiedades al campo de texto y asignarle la tabla en la que se insertarán los datos introducidos desde este formulario.</p>
<p>Seleccionamos dicho cuadro con el botón derecho y nos sale un cuadro emergente, y dentro de él escogemos “Campo de Control”.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image112.png" id="image116">
<p>En el cuadro resultante, vamos a la ficha “Datos”, y seleccionamos dentro de “Campo de datos” el nombre del campo al cual se va a enlazar, en este caso, al campo Id_Interprete.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image113.png" id="image117">
<p>Dentro de esta misma ventana de propiedades del campo, nos vamos a la ficha “General” al campo “Nombre” y escribimos CampoId_Interprete.</p>
<p>Una buena práctica es dar un nombre significativo a cada campo que creemos, sobre todo cuando tengamos formularios con muchos campos. Así, podremos distinguir bien cada campo dentro de la ventana “Navegador de Formularios”.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image114.png" id="image118">
<p>Colocar un campo de etiqueta</p>
<p>Delante del campo de texto creado vamos a poner un “Campo etiqueta” para que cualquier usuario que utilice el formulario conozca lo que debe introducir.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image115.png" id="image119">
<p>Si hacemos doble clic sobre la etiqueta aparecerá una ventana donde podremos indicar las diferentes propiedades de la etiqueta (nombre que aparecerá en la etiqueta, color de fondo, tipo de letra, tamaño, color,...).</p>
<p>El formato de los formularios puede tener más colorido y distintas fuentes de texto.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image116.png" id="image120">
<p>Dentro de estas propiedades vemos que hay algunas que nos abren una nueva ventana como, por ejemplo, la propiedad “Fuente” donde podemos variar el tamaño y el tipo de la fuente del texto.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image117.png" id="image121">
<p>Una vez que hemos cambiado las propiedades de la etiqueta, nuestro formulario debería. parecerse al de la figura.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image118.png" id="image122">
<p>Completar el resto de campos del formulario</p>
<p>Si repetimos los pasos realizados para el resto de los campos de la tabla Interpretes podríamos obtener un formulario parecido a este.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image119.png" id="image123">
<p>Guardar cambios</p>
<p>Si salvamos los cambios realizados y cerramos la ventana de edición de formularios, en la ventana de objetos ya debe aparecer el formulario que acabamos de crear.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image120.png" id="image124">
<p>Editar el formulario</p>
<p>Si queremos realizar algún cambio en el formato del formulario, pulsamos sobre el formulario con el botón derecho del ratón y elegimos la opción ‘Editar’.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image121.png" id="image125">
<p>Ejecutar el formulario</p>
<p>En cambio, si lo que queremos es ejecutar el formulario para empezar a insertar datos hacemos doble clic sobre él .</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image122.png" id="image126">
<p>Veréis que abajo aparece el número de registros (filas) que hay guardados en esta tabla y podremos ir viendo la información guardada en el formulario.</p>
<h1 id="20-faq">20. FAQ</h1>
<p>Me aparece un error al intentar guardar información en una tabla.</p>
<p>Recordad rellenar las filas de una en una, y no toda una columna</p>
<p>Es posible que alguno de los campos lo hayamos definido con una longitud corta y hayamos escrito algo más largo. Editar los campos de la tabla y revisarlo.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image123.png" id="image127">
<p>No me deja rellenar una tabla</p>
<p>Comprueba que en la tabla hayas definido un campo como clave principal.</p>
<img src="file:///e:/Docencia/apuntes/basesdedatos/media/image124.png" id="image128">
</body>
</html>
